{"version":3,"sources":["Form.js","Canvas.js","Wiki.js","index.js"],"names":["Form","props","onSubmit","Search","className","type","Canvas","canvasRef","useRef","draw","ctx","cvs","img","Image","crossOrigin","src","w","h","width","drawImage","imageData","getImageData","data","len","length","palette","color","c","parseInt","r","g","b","a","calculateQuantError","o","n","oc","nc","i","oldColor","newColor","qe","e","putImageData","useEffect","animationFrameId","canvas","current","context","getContext","cancel","window","cancelAnimationFrame","render","requestAnimationFrame","console","log","setTimeout","height","ref","fetch","require","Wiki","useState","image","setImage","title","setTitle","setWidth","setHeight","preventDefault","searchTerm","target","elements","value","url_search","search_response","json","search_json","term","backup_term","pageURL","substr","page_url_response","final","pageURL2","backup_response","backupfinal","Object","entries","query","pages","original","source","Math","floor","href","id","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.25f28d23.chunk.js","sourcesContent":["import React from \"react\";\n\nconst Form = props => (\n\t<form onSubmit={props.Search}>\n\t\t<div className=\"search-form\">\n\t\t<input className=\"Search-input\" type=\"text\" className=\"Textbox\" name=\"searchTerm\" placeholder=\"show me a...\"/>\n\t\t<button className=\"Search-button\">Dither!</button>\n\t\t</div>\n\t</form>\n);\n\nexport default Form;","import React, { useRef, useEffect } from 'react'\n\nconst Canvas = props => {\n\n    const canvasRef = useRef(null)\n    \n    const draw = (ctx, cvs) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      img.src = props.src;\n      const w = 300;\n      const h = (props.h); \n      const test = ctx.width;\n      img.crossOrigin = 'anonymous';\n      ctx.drawImage(img, 0, 0, w, h);\n      const imageData = ctx.getImageData(0, 0, w, h);\n      const data = imageData.data;\n      const len = data.length;\n\n      function palette(color) {\n        var c = parseInt(((color.r + color.g + color.b) / 3) > 128 ? 255 : 0);\n        return { r: c, g: c, b: c, a: 255 };\n      }\n            \n      function calculateQuantError(o, n) {\n          var oc = parseInt((o.r + o.g + o.b) / 3),\n          nc = parseInt((n.r + n.g + n.b) / 3);\n          return { r: oc - nc, g: oc - nc, b: oc - nc, a: 255 };\n      }\n      \n      for(var i = 0; i < len; i+=4) {\n          \n          var oldColor = {\n                  r: data[i+0],\n                  g: data[i+1],\n                  b: data[i+2],\n                  a: data[i+3]\n          };\n          var newColor = palette(oldColor);\n\n          data[i+0] = newColor.r;\n          data[i+1] = newColor.g;\n          data[i+2] = newColor.b;\n          data[i+3] = newColor.a;\n              \n          var qe = calculateQuantError(oldColor, newColor);\n\n          try {\n              data[i+0+4] += 7/16 * qe.r;\n              data[i+1+4] += 7/16 * qe.g;\n              data[i+2+4] += 7/16 * qe.b;\n              data[i+3+4] += 7/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0-4+w*4] += 3/16 * qe.r;\n              data[i+1-4+w*4] += 3/16 * qe.g;\n              data[i+2-4+w*4] += 3/16 * qe.b;\n              data[i+3-4+w*4] += 3/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0+w*4] += 5/16 * qe.r;\n              data[i+1+w*4] += 5/16 * qe.g;\n              data[i+2+w*4] += 5/16 * qe.b;\n              data[i+3+w*4] += 5/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0+4+w*4] += 1/16 * qe.r;\n              data[i+1+4+w*4] += 1/16 * qe.g;\n              data[i+2+4+w*4] += 1/16 * qe.b;\n              data[i+3+4+w*4] += 1/16 * qe.a;\n          } catch(e) {}\n          }\n          ctx.putImageData(imageData, 0, 0); \n    }\n  \n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    let animationFrameId;\n    const cancel = () => {\n      window.cancelAnimationFrame(animationFrameId)\n    }\n    const render = () => {\n      draw(context, canvas)\n      animationFrameId = window.requestAnimationFrame(render)\n      console.log(\"frame: \" + animationFrameId)\n      setTimeout(cancel, 2000)\n    }\n    render()\n    return () => {\n      window.cancelAnimationFrame(animationFrameId)\n    }\n  }, [draw])\n\n  return (\n    <canvas width={props.w} height={props.h} ref={canvasRef} {...props}/>\n  ) \n}\n\nexport default Canvas","import React, { useState , useRef, useEffect} from 'react';\nimport Form from './Form';\nimport Canvas from './Canvas';\nconst fetch = require(\"node-fetch\");\n\n\nconst Wiki = () => {\n\n  const [image, setImage] = useState(\"https://upload.wikimedia.org/wikipedia/commons/1/10/Tursiops_truncatus_01.jpg\");\n  const [title, setTitle] = useState(\"Dolphin dithered\");\n  const [width, setWidth] = useState(300);\n  const [height, setHeight] = useState(210);\n\n   \n  const Search = async (e) => {\n\n    e.preventDefault();\n    const searchTerm = e.target.elements.searchTerm.value;\n    if (!searchTerm) {\n      setTitle(\"check 1\");\n      return;\n    }\n    const url_search = `https://en.wikipedia.org/w/api.php?origin=*&action=opensearch&search=${searchTerm}&format=json`;\n    const search_response = await fetch(url_search);\n    //console.log(\"search reponse: \" + search_response)\n    const search_json = await search_response.json();\n    console.log(\"search json: \" + search_json)\n    if (search_json[3].length === 0){\n      setTitle(\"no image found :(\");\n      return;\n    }\n    const term = search_json[3][0];\n    console.log(\"term 1: \" + term)\n    const backup_term = search_json[3][1];\n    console.log(\"term 2: \" + backup_term)\n    let final;\n    let backupfinal;\n    const pageURL = `https://en.wikipedia.org/w/api.php?origin=*&action=query&prop=pageimages&format=json&piprop=original&titles=${term.substr(30,)}`;\n    const page_url_response = await fetch(pageURL)\n    final = await page_url_response.json();\n    if (backup_term) {\n      const pageURL2 = `https://en.wikipedia.org/w/api.php?origin=*&action=query&prop=pageimages&format=json&piprop=original&titles=${backup_term.substr(30,)}`;\n      const backup_response = await fetch(pageURL2)\n      backupfinal = await backup_response.json();\n    }\n    if (Object.entries(final.query.pages)[0][1].original) {\n      setImage(Object.entries(final.query.pages)[0][1].original.source);\n      setTitle(search_json[1][0] + \" dithered\");\n      const w = Object.entries(final.query.pages)[0][1].original.width;\n      const h = Object.entries(final.query.pages)[0][1].original.height;\n      setWidth(300);\n      setHeight(Math.floor((300/w)*h));\n    }\n    else if (backupfinal) {\n      if (Object.entries(backupfinal.query.pages)[0][1].original){\n      setImage(Object.entries(backupfinal.query.pages)[0][1].original.source);\n      setTitle(search_json[1][0] + \" dithered\");\n      const w = Object.entries(backupfinal.query.pages)[0][1].original.width;\n      const h = Object.entries(backupfinal.query.pages)[0][1].original.height;\n      setWidth(300);\n      setHeight(Math.floor((300/w)*h));\n      }\n      else {\n        setTitle(\"no image found :(\");\n        setImage(\"\");\n      }\n    }\n    else {\n      setTitle(\"no image found :(\");\n      setImage(\"\");\n      //console.log(Object.entries(final.query));\n    }\n  }  \n\n  return (\n    <div className=\"container\">\n      <div className=\"Box\">\n        <h3>WikiDither</h3>\n        <p>search something on Wikipedia (the free encyclopedia) and see \n        its page image dithered using the <a href = \"https://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering\">Floyd-Steinberg Dithering Algorithm</a>.\n        </p>\n        <Form Search={Search}/>\n        &nbsp;\n        <Canvas className=\"dithered-image\" id=\"wiki_dither\" src={image} w={width} h={height} />\n        <p className=\"caption\">{title}</p>\n      </div>\n    </div>\n  )\n}\n\nexport default Wiki;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './App.css';\n\nimport Wiki from './Wiki';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Wiki />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\n"],"sourceRoot":""}