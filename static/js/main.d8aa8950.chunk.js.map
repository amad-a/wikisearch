{"version":3,"sources":["Form.js","Canvas.js","Wiki.js","index.js"],"names":["Form","props","onSubmit","Search","className","type","Canvas","canvasRef","useRef","draw","ctx","img","Image","crossOrigin","src","w","h","drawImage","imageData","getImageData","data","len","length","palette","color","c","parseInt","r","g","b","a","calculateQuantError","o","n","oc","nc","i","oldColor","newColor","qe","e","putImageData","useEffect","animationFrameId","context","current","getContext","cancel","window","cancelAnimationFrame","render","requestAnimationFrame","setTimeout","width","height","ref","fetch","require","Wiki","useState","image","setImage","title","setTitle","setWidth","setHeight","preventDefault","searchTerm","target","elements","value","uriTerm","encodeURIComponent","url_search","response","json","parsed","encodedTitle","template","image_response","image_parsed","query","pages","hasOwnProperty","console","log","original","source","Math","floor","href","id","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d8aa8950.chunk.js","sourcesContent":["import React from \"react\";\n\nconst Form = props => (\n\t<form onSubmit={props.Search}>\n\t\t<div className=\"search-form\">\n\t\t<input className=\"Search-input\" type=\"text\" className=\"Textbox\" name=\"searchTerm\" placeholder=\"show me a...\"/>\n\t\t<button className=\"Search-button\">Dither!</button>\n\t\t</div>\n\t</form>\n);\n\nexport default Form;","import React, { useRef, useEffect } from 'react'\n\nconst Canvas = props => {\n\n    const canvasRef = useRef(null)\n    \n    const draw = (ctx) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      img.src = props.src;\n      const w = 300;\n      const h = (props.h); \n      img.crossOrigin = 'anonymous';\n      ctx.drawImage(img, 0, 0, w, h);\n      const imageData = ctx.getImageData(0, 0, w, h);\n      const data = imageData.data;\n      const len = data.length;\n\n      const palette = (color) => {\n        let c = parseInt(((color.r + color.g + color.b) / 3) > 128 ? 255 : 0);\n        return { r: c, g: c, b: c, a: 255 };\n      }\n            \n      const calculateQuantError = (o, n) => {\n          let oc = parseInt((o.r + o.g + o.b) / 3),\n              nc = parseInt((n.r + n.g + n.b) / 3);\n          return { r: oc - nc, g: oc - nc, b: oc - nc, a: 255 };\n      }\n      for(let i = 0; i < len; i+=4) {\n          let oldColor = {\n                  r: data[i+0],\n                  g: data[i+1],\n                  b: data[i+2],\n                  a: data[i+3]\n          };\n          let newColor = palette(oldColor);\n          data[i+0] = newColor.r;\n          data[i+1] = newColor.g;\n          data[i+2] = newColor.b;\n          data[i+3] = newColor.a;\n          let qe = calculateQuantError(oldColor, newColor);\n\n          try {\n              data[i+0+4] += 7/16 * qe.r;\n              data[i+1+4] += 7/16 * qe.g;\n              data[i+2+4] += 7/16 * qe.b;\n              data[i+3+4] += 7/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0-4+w*4] += 3/16 * qe.r;\n              data[i+1-4+w*4] += 3/16 * qe.g;\n              data[i+2-4+w*4] += 3/16 * qe.b;\n              data[i+3-4+w*4] += 3/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0+w*4] += 5/16 * qe.r;\n              data[i+1+w*4] += 5/16 * qe.g;\n              data[i+2+w*4] += 5/16 * qe.b;\n              data[i+3+w*4] += 5/16 * qe.a;\n          } catch(e) {}\n          try {\n              data[i+0+4+w*4] += 1/16 * qe.r;\n              data[i+1+4+w*4] += 1/16 * qe.g;\n              data[i+2+4+w*4] += 1/16 * qe.b;\n              data[i+3+4+w*4] += 1/16 * qe.a;\n          } catch(e) {}\n          }\n          ctx.putImageData(imageData, 0, 0); \n    }\n  \n  useEffect(() => {\n    let timeout = 2000;\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    let animationFrameId;\n    const cancel = () => {\n      window.cancelAnimationFrame(animationFrameId)\n    }\n    const render = () => {\n      draw(context)\n      animationFrameId = window.requestAnimationFrame(render)\n      //console.log(\"frame: \" + animationFrameId)\n      setTimeout(cancel, timeout)\n    }\n    render()\n    return () => {\n      window.cancelAnimationFrame(animationFrameId)\n    }\n  }, [draw])\n\n  return (\n    <canvas width={props.w} height={props.h} ref={canvasRef} {...props}/>\n  ) \n}\n\nexport default Canvas","import React, { useState , useRef, useEffect} from 'react';\nimport Form from './Form';\nimport Canvas from './Canvas';\nconst fetch = require(\"node-fetch\");\n\n\nconst Wiki = () => {\n\n  const [image, setImage] = useState(\"https://upload.wikimedia.org/wikipedia/commons/1/10/Tursiops_truncatus_01.jpg\");\n  const [title, setTitle] = useState(\"Dolphin dithered\");\n  const [width, setWidth] = useState(300);\n  const [height, setHeight] = useState(210);\n\n   \n  const Search = async (e) => {\n    e.preventDefault();\n    const searchTerm = e.target.elements.searchTerm.value;\n    if (!searchTerm){\n      return;\n    };\n    const uriTerm = encodeURIComponent(searchTerm)\n    const url_search = `https://en.wikipedia.org/w/api.php?origin=*&action=opensearch&search=${uriTerm}&format=json`;\n    const response = await fetch(url_search);\n    const parsed = await response.json();\n    const pageTitle = parsed[1][0];\n    const encodedTitle = encodeURIComponent(parsed[1][0]);\n    const template = `https://en.wikipedia.org/w/api.php?origin=*&action=query&format=json&formatversion=2&prop=pageimages%7Cpageterms&titles=${encodedTitle}&pilimit=3&piprop=original&pilicense=any&wbptterms=description&redirects=`\n    const image_response = await fetch(template);\n    const image_parsed = await image_response.json();\n  \n    if (image_parsed.query.pages[0].hasOwnProperty('original')){\n        console.log(image_parsed.query.pages[0]);\n        const w = image_parsed.query.pages[0].original.width;\n        const h = image_parsed.query.pages[0].original.height;\n        setImage(image_parsed.query.pages[0].original.source);\n        setWidth(300);\n        setHeight(Math.floor((300/w)*h));\n        setTitle(image_parsed.query.pages[0].title + \" dithered\");\n    }\n    else {\n      setTitle('image not found!');\n      return;\n    };\n  }; \n\n  return (\n    <div className=\"container\">\n      <div className=\"Box\">\n        <h3>WikiDither</h3>\n        <p>search something on Wikipedia (the free encyclopedia) and see \n        its page image dithered using the <a href=\"https://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering\">\n        Floyd-Steinberg Dithering Algorithm</a>.</p>\n        <Form Search={Search}/>\n        &nbsp;\n        <Canvas className=\"dithered-image\" id=\"wiki_dither\" src={image} w={width} h={height} />\n        <p className=\"caption\">{title}</p>\n      </div>\n    </div>\n  )\n}\n\nexport default Wiki;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './App.css';\n\nimport Wiki from './Wiki';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Wiki />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\n"],"sourceRoot":""}